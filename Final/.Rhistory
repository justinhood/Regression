gpa=c(3.26,2.60,3.35,2.86,3.82,2.21,3.47)
salary=c(33.8,29.8,33.5,30.4,36.4,27.6,35.3)
mean(gpa)
sum(gpa*gpa)-(sum(gpa)**2)/7
1/7
1/7+((3.25-mean(gpa))**2)/(sum(gpa*gpa)-(sum(gpa)**2)/7)
2.447*.536321*sqrt(.158295)
33.362+2.447*.536321*sqrt(.158295)
33.362-2.447*.536321*sqrt(.158295)
33.362-2.571*.536321*sqrt(.158295)
33.362+2.571*.536321*sqrt(.158295)
33.362-2.571*.536321*sqrt(1+.158295)
33.362+2.571*.536321*sqrt(1+.158295)
11.46409+24.60221*4
11.46409+24.60221*5
138.1968-24.60221
time=c(8.0,4.7,3.7,2.8,8.9)
experience=c(1,8,4,16,1)
time=c(8.0,4.7,3.7,2.8,8.9,5.8,2.0,1.9,3.3)
experience=c(1,8,4,16,1,2,12,5,3)
plot(experience,time)
plot(experience,1/time)
invtime=time^(-1)
invexp=experience^(-1)
plot(invexp, time)
delete invtime
delete(invtime)
rm(invtime)
clear
rm(plot)
plot(invexp,time)
rm(all)
clc
experience=(1 8 4 16 1 2 12 5 3)
experience=(1,8,4,16,1,2,12,5,3)
experience=c(1 8 4 16 1 2 12 5 3)
experience=c(1,8,4,16,1,2,12,5,3)
experience=c(1,8,4,16,1,2,12,5,3)
time=c(8,4.7,3.7,2.8,8.9,5.8,2.0,1.9,3.3)
invexp=experience^(-1)
plot(invexp,time)
mod=lm(time ~ invexp)
summary(mod_)
summary(mod)
model.response(5)
2.0575+6.3537*5
2.0575+6.3537/5
SSE=sum(time**2)-(2.0575*sum(time)+6.3537*sum(time*invexp))
s2=SSE/7
s=sqrt(s2)
SSxx=sum(invexp**2)-((sum(invexp)))
SSxx=sum(invexp**2)-((sum(invexp))**2/9)
mean(invexp)
dist=1/9+((.2-mean(invexp))**2)/SSxx
v=s*2.365*sqrt(1+dist)
3.32824+v
3.32824-v
invexp
x=c(1,2,3)
y=c(4,5,6)
mod<- lm(y~x)
summary mod
summary(mod)
sum(x^2)
sum(y)
sum(x)
sum(xy)
sum(x*y)
x=c(1,2,3)
y=c(4,5,6)
mod <- lm(y~x)
summary(mod)
3*mean(y)*sum(x**2)-3*mean(x)*sum(x*y)
sum(x**2)-9*mean(x)**2
3*sum(x**2)-98mean(x)**2
3*sum(x**2)-9*mean(x)**2
3*sum(x*y)-9*mean(x)*mean(y)
clear()
setwd("~/Desktop/PSM/Fall 2018/Regression/Final")
motel<-read.csv("./motel.txt", header = TRUE)
motel$y
t=1:size(motel$y)
t=1:length(motel$y)
t
plot(t, motel$y)
plot(t, log(motel$y))
plot(t, motel$y)
png('motel.png')
plot(t, motel$y)
dev.off()
lines(t,motel$y)
lines(t,motel$y, xlab="Time, t", ylab="Rooms Occupied")
lines(t,motel$y, xlab="Time, t", ylab="Rooms Occupied")
plot(t,motel$y, xlab="Time, t", ylab="Rooms Occupied")
lines(t,motel$y)
plot(t,motel$y, xlab="Time, t", ylab="Rooms Occupied", title="Rooms Occupied over Time in Months")
plot(t,motel$y, xlab="Time, t", ylab="Rooms Occupied", main="Rooms Occupied over Time in Months")
warnings(())
warnings()
warnings()
plot(t,motel$y, xlab="Time, t", ylab="Rooms Occupied", main="Rooms Occupied over Time in Months")
png('motel.png')
plot(t,motel$y, xlab="Time, t", ylab="Rooms Occupied", main="Rooms Occupied over Time in Months")
lines(t,motel$y)
dev.off()
plot(t,motel$y, xlab="Time, t", ylab="Rooms Occupied", main="Rooms Occupied over Time in Months")
logged=log(motel$y)
plot(t,logged)
lines(t,logged)
png('loggedmotel.png')
plot(t,logged,main="Log of Rooms Occupied vs Time", xlab = "Time, t", ylab="Log of Rooms Occupied")
lines(t,logged)
dev.off()
M1=rep(c(1,0,0,0,0,0,0,0,0,0,0,0), length.out=length(logged))
M1
M2=rep(c(0,1,0,0,0,0,0,0,0,0,0,0), length.out=length(logged))
M3=rep(c(0,0,1,0,0,0,0,0,0,0,0,0), length.out=length(logged))
M4=rep(c(0,0,0,1,0,0,0,0,0,0,0,0), length.out=length(logged))
M5=rep(c(0,0,0,0,5,0,0,0,0,0,0,0), length.out=length(logged))
M5=rep(c(0,0,0,0,1,0,0,0,0,0,0,0), length.out=length(logged))
M6=rep(c(0,0,0,0,0,1,0,0,0,0,0,0), length.out=length(logged))
M7=rep(c(0,0,0,0,0,0,1,0,0,0,0,0), length.out=length(logged))
M8=rep(c(0,0,0,0,0,0,0,1,0,0,0,0), length.out=length(logged))
M9=rep(c(0,0,0,0,0,0,0,0,1,0,0,0), length.out=length(logged))
M10=rep(c(0,0,0,0,0,0,0,0,0,1,0,0), length.out=length(logged))
M11=rep(c(0,0,0,0,0,0,0,0,0,0,1,0), length.out=length(logged))
M12=rep(c(0,0,0,0,0,0,0,0,0,0,0,1), length.out=length(logged))
motelmod<-lm(logged~t+M2+M3+M4+M5+M6+M7+M8+M9+M10+M11+M12)
summary(motelmod)
logged
test1=data.frame('t'=1)
predict(motelmod, test1)
test1=data.frame('t'=1, 'M2'=0, 'M3'=0, 'M4'=0, 'M5'=0, 'M6'=0, 'M7'=0, 'M8'=0),'M9'=0,'M10'=0,'M11'=0,'M12'=0)
test1=data.frame('t'=1, 'M2'=0, 'M3'=0, 'M4'=0, 'M5'=0, 'M6'=0, 'M7'=0, 'M8'=0,'M9'=0,'M10'=0,'M11'=0,'M12'=0)
predict(motelmod, test1)
test2=data.frame('t'=186, 'M2'=0, 'M3'=0, 'M4'=0, 'M5'=0, 'M6'=1, 'M7'=0, 'M8'=0,'M9'=0,'M10'=0,'M11'=0,'M12'=0)
predict(motelmod, test2)
testjuly=data.frame('t'=187, 'M2'=0, 'M3'=0, 'M4'=0, 'M5'=0, 'M6'=0, 'M7'=1, 'M8'=0,'M9'=0,'M10'=0,'M11'=0,'M12'=0)
predict(motelmod, testjuly)
predict(motelmod, testjuly, interval = predict())
predict(motelmod, testjuly, interval = predict
)
predict(motelmod, testjuly, interval = 'predict')
testaug=data.frame('t'=188, 'M2'=0, 'M3'=0, 'M4'=0, 'M5'=0, 'M6'=0, 'M7'=0, 'M8'=1,'M9'=0,'M10'=0,'M11'=0,'M12'=0)
predict(motelmod, testaug, interval = 'predict')
e^6.12285
exp(6.12285)
exp(6.066414)
exp(6.042155)
testsep=data.frame('t'=189, 'M2'=0, 'M3'=0, 'M4'=0, 'M5'=0, 'M6'=0, 'M7'=0, 'M8'=0,'M9'=1,'M10'=0,'M11'=0,'M12'=0)
predict(motelmod, testsep, interval = 'predict')
motelmod$residuals
evec=motelmod$residuals
evecBig=evec(1:length(evec)-1)
evecBig=evec(1:(length(evec)-1)
)
evec
evecBig=evec(1:185)
evecBig=evec[1:185]
evecSmall=evec[2:186]
sum((evecSmall-evecBig)^2)
sum(evec**2)
sum((evecSmall-evecBig)^2)/sum(evec**2)
acf <- acf(cod, type="correlation")
library(lmtest)
library(car)
library(forecast)
library(fpp)
acf <- acf(cod, type="correlation")
acf(logged)
acf(motel)
acf(motel)
plot(t,evec)
lines(t,evec)
x=c(1,2,3,4,5,6,7,8,9,10,11,12)
d=C30.5,29.5,30.5,33.5,38.5,33.5,38.5,37.5,34.5,41.5,34.5,45.5)
d=c(30.5,29.5,30.5,33.5,38.5,33.5,38.5,37.5,34.5,41.5,34.5,45.5)
linmod<-lm(d~t)
linmod<-lm(d~x)
summary(linmod)
## Autocorrelation ##
ybar <- mean(motel$y)
y1 <- y[2:186]
y1 <- motel$y[2:186]
y2 <- motel$y[1:185]
sp <- sum((y1-ybar)*(y2-ybar))
ss <- sum((motel$y-ybar)^2)
ac <- sp/ss
acf <- acf(motel, type="correlation")
summary(acf)
acf <- acf(motel, type="correlation")
pacf <- pacf(motel, type="correlation")
png('acf.png')
png('acf.png')
acf <- acf(motel, type="correlation")
dev.off()
ac
fit<- lm(motel$y~t)
yhat <- fitted((fit))
err <- motel$y-yhat
x1 <- err[2:186]
x2 <- err[1:185]
d <- (sum((x1-x2)^2))/ (sum(err^2))
dwtest(motel$y~t)
df <- data.frame(motel$y)
df <- data.frame(motel$y, trend=t, month=rep((1:12),length.out=186)
df
df <- data.frame(motel$y, trend=t, month=rep((1:12),length.out=186))
df
xreg <- cbind(trend=df$trend, month=model.matrix(~as.factor(df$month)))
xreg <- xreg[,-3]
tsarima <- ts(df$motel.y, frequency = 12)
colnames(xreg)<- c("trend","February","March","April","May","June","July", "August","September","October","November","December")
fitArima <- Arima(tsarima, xreg=xreg, order=c(1,0,0))
fitArima <- Arima(tsarima, xreg=xreg)
tsarima
xreg
df <- data.frame(motel$y, trend=t, month=rep((1:12),length.out=186))
df
xreg <- cbind(trend=df$trend, month=model.matrix(~as.factor(df$month)))
xreg
xreg <- xreg[,-2]
xreg
tsarima <- ts(df$motel.y, frequency = 12)
colnames(xreg)<- c("trend","February","March","April","May","June","July", "August","September","October","November","December")
fitArima <- Arima(tsarima, xreg=xreg, order=c(1,0,0))
summary(fitArima)
b<-coefficients(fitArima)
yhat<-fitted(fitArima)
errors<-motel$y-yhat
errors
sum(errors)
sum(errors^2)
sum(errors^2)/185
sum(errors^2)/184
sum(errors^2)/(186-13)
sum(errors^2)/(186-14)
sqrt(sum(errors^2)/(186-14))
b
yhat
yhat[186]
motel$y[186]
yaht[186]-motel$y[186]
yhat[186]-motel$y[186]
#### Q4 ########3
tiger <- read.csv("./tiger.txt")
tiger
tiger <- read.csv("./tiger.txt", header = TRUE)
clear tiger
clear(tiger)
View(tiger)
View(tiger)
View(tiger)
rm(tiger)
tiger <- read.csv("./tiger.txt", header = TRUE)
tiger
y <- tiger$X.y.
y1 <- ts(tiger,start = 1, frequency = 4)
ts.plot(y1, ylab="Sales of Tiger Drink", xlab="Quarter",main="Time Series")
png("tigersales.png")
ts.plot(y1, ylab="Sales of Tiger Drink", xlab="Quarter",main="Time Series")
dev.off()
fit1 <- hw(y1, alpha=0.2, beta=0.1, gamma=0.1, seasonal="multiplicative", level=.95)
plot(fit1)
summary(fit1)
accuracy(fit1)
yhatmult<-fitted(fit1)
errormult <- tiger$X.y.-yhatmult
MSEmult <- sum(errormult^2)
mean(MSEmult)
fit2<-hw(y1, seasonal="multiplicative", level=.95)
summary(fit2)
yhatmultopt<-fitted(fit2)
errormultopt <- tiger$X.y.-yhatmultopt
MSEmultopt <- sum(errormultopt^2)
mean(MSEmultopt)
q1 <- forecast(fit2, n.ahead=1, prediction.interval = TRUE)
q1
fit3 <- hw(log(y1), alpha=.2, beta=0.1,gamma=.1,seasonal="additive")
summary(fit3)
yhatadd<-fitted(fit3)
erradd<-tiger$X.y.-yhatadd
MSEadd <- sum(erradd^2)
mean(MSEadd)
erradd<-log(tiger$X.y.)-yhatadd
MSEadd <- sum(erradd^2)
mean(MSEadd)
fit4 <- hw(log(y1),seasonal="additive",level = .95)
summary(fit4)
yhataddopt <- fitted(fit4)
erraddopt <- log(tiger$X.y.)-yhataddopt
MSEaddopt <- sum(erraddopt^2)
mean(MSEaddopt)
q1 <- forecast(fit4, n.ahead=1, prediction.interval = TRUE)
q1
save.image("~/Desktop/PSM/Fall 2018/Regression/Final/FinalRSpace.RData")
